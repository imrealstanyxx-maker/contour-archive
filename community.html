<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>КОНТУР — Наблюдения</title>
  <link rel="stylesheet" href="assets/style.css" />
</head>
<body>
  <header class="top">
    <div class="brand">
      <a class="back" href="index.html">← Архив</a>
      <div class="logo">КОНТУР</div>
      <div class="sub">Наблюдения сообщества</div>
    </div>

    <div class="controls">
      <a class="btn-link" href="index.html">Архив</a>
      <a class="btn-link" href="profile.html">Профиль</a>
    </div>
  </header>

  <main class="wrap">
    <section class="panel" id="no-license-section" style="display: none;">
      <div class="panel-title">Требуется лицензия</div>
      <div class="panel-body prose">
        <p>Для создания наблюдений требуется лицензия наблюдателя.</p>
        <a href="license.html" class="btn-link" style="display: inline-block; margin-top: 16px;">
          Подать заявку на лицензию
        </a>
      </div>
    </section>

    <section class="panel" id="create-section" style="display: none;">
      <div class="panel-title">Создать наблюдение</div>
      <div class="panel-body">
        <form id="report-form">
          <div style="margin-bottom: 16px;">
            <label style="display: block; margin-bottom: 8px; font-size: 14px;">Связано с досье (опционально)</label>
            <select id="dossier-id" name="dossier_id" class="select">
              <option value="">Не привязано</option>
            </select>
          </div>
          
          <div style="margin-bottom: 16px;">
            <label style="display: block; margin-bottom: 8px; font-size: 14px;">Название *</label>
            <input type="text" name="title" class="input" required placeholder="Краткое описание наблюдения" />
          </div>
          
          <div style="margin-bottom: 16px;">
            <label style="display: block; margin-bottom: 8px; font-size: 14px;">Описание *</label>
            <textarea name="body" class="input" required placeholder="Подробное описание наблюдения" style="min-height: 120px;"></textarea>
          </div>
          
          <div style="margin-bottom: 16px;">
            <label style="display: block; margin-bottom: 8px; font-size: 14px;">Доказательства (опционально)</label>
            <textarea name="evidence" class="input" placeholder="Фотографии, документы, свидетельства" style="min-height: 80px;"></textarea>
          </div>
          
          <div style="margin-bottom: 16px;">
            <label style="display: block; margin-bottom: 8px; font-size: 14px;">Локация (опционально)</label>
            <input type="text" name="location" class="input" placeholder="Где было наблюдение" />
          </div>
          
          <div style="margin-bottom: 16px;">
            <label style="display: block; margin-bottom: 8px; font-size: 14px;">Дата и время наблюдения (опционально)</label>
            <input type="datetime-local" name="observed_at" class="input" />
          </div>
          
          <div id="form-error" class="note" style="display: none; color: #ef4444; margin-bottom: 16px;"></div>
          <div id="form-success" class="note" style="display: none; color: #34d399; margin-bottom: 16px;"></div>
          
          <button type="submit" class="btn-link" style="width: 100%;">
            Отправить наблюдение
          </button>
        </form>
      </div>
    </section>

    <section class="panel">
      <div class="panel-title">Наблюдения</div>
      <div class="panel-body">
        <div style="display: flex; gap: 8px; margin-bottom: 16px; flex-wrap: wrap;">
          <button class="btn-link filter-btn active" data-filter="all">Все</button>
          <button class="btn-link filter-btn" data-filter="my">Мои отчёты</button>
          <button class="btn-link filter-btn" data-filter="unofficial">Неофициально</button>
          <button class="btn-link filter-btn" data-filter="approved">Подтверждено</button>
          <button class="btn-link filter-btn" data-filter="pending">На рассмотрении</button>
          <button class="btn-link filter-btn" data-filter="moderation" id="moderation-btn" style="display: none; background: rgba(239, 68, 68, 0.15); border-color: rgba(239, 68, 68, 0.3);">Модерация</button>
        </div>
        <div id="reports-list"></div>
      </div>
    </section>
  </main>

  <script src="assets/config.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="assets/supabase-auth.js"></script>
  <script src="assets/github-issues.js"></script>
  <script src="assets/community.js"></script>
</body>
</html>

